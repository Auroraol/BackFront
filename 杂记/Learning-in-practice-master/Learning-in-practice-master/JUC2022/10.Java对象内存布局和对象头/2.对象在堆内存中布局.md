# 权威定义

### 周志明老师JVM第三版

![image-20230723152446040](images/1.周志明老师JVM第三版.png)

### 对象在堆内存中的存储布局

![image-20230723155600930](images/2.对象在堆内存中的存储布局.png)

对象内部结构分为：对象头、实例数据、对齐填充（保证8个字节的倍数）。

对象头分为对象标记（markOop)和类元信息（klassOop)，类元信息存储的是指向该对象类元数据（klass)的首地址。

1. 对象头

   #### 对象标记 Mark Word

   ##### 它保存的是什么：

   ![image-20230724225623357](images/3.对象头保存的数据.png)

   ![image-20230724225756888](images/4.保存数据.png)

   <font color = 'red'>在64位系统中，Mark Word占了8个字节，类型指针占了8个字节，共是16个字节</font>

   ![image-20230724230326466](images/5.mark-word存储结构.png)

   默认存储对象的HashCode、分代年龄和锁标志位等信息。

   这些信息都是与对象自身定义无关的数据，所以MarkWord被设计成一个非固定的数据结构以便在极小的空间内存存储尽量多的数据。

   它会根据对象的状态复用自己的存储空间，也就是说在运行期间MarkWord里存储的数据会随着锁标志位的变化而变化。

   #### 类元信息(又叫类型指针)

   ![image-20230729070743387](images/6.类型指针.png)

   对象指向它的类元数据的指针，虚拟机通过这个指针来确定这个对象是哪个类的实例

   #### 对象头多大

   在64位系统中，Mark Word占了8个字节，类型指针占了8个字节，一共是16个字节。

2. 实例数据

   存放类的属性(Field)数据信息，包括父类的属性信息

3. 对齐填充

   虚拟机要求对象起始地址必须是8字节的整数倍。填充数据不是必须存在的，仅仅是为了字节对齐这部分内存按8字节补充对齐。

# 再说对象头MarkWord

### 32位，了解即可

![image-20230729072446277](images/7.32位虚拟机.png)

### 64位

![image-20230729072623572](images/8.64位虚拟机.png)





