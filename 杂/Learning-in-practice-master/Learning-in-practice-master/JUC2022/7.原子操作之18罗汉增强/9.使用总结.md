# AtomicLong

线程安全，可允许一些性能损耗，要求高精度时可使用

保证精度，性能代价

AtomicLong是多个线程针对单个热点值value进行原子操作

### 原理

CAS+自旋，incrementAndGet

### 场景

低并发下的全局计算

AtomicLong能保证并发情况下计数的准确性，其内部通过CAS来解决并发安全性的问题。

### 缺陷

高并发后性能急剧下降

why? AtomicLong的自旋会成为瓶颈

**N个线程CAS操作修改线程的值，每次只有一个成功过，其它N-1失败，失败的不停的自旋直到成功，这样大量失败自旋的情况，一下子cpu就打高了。**

# LongAdder

当需要在高并发下有较好的性能表现，且对值的精确度要求不高时，可以使用

保证性能，精度代价

LongAdder是每个线程拥有自己的槽，各个线程一般只对自己槽中的那个值进行CAS操作

### 原理

CAS+Base+Cell数组分散

空间换时间并分散了热点数据

### 场景

高并发下的全局计算

### 缺陷

sum求和后还有计算线程修改结果的话，最后结果不够准确



